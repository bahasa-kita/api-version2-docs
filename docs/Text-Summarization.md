# **Text Summarization API**
API Text Summarization Documentation is guidance for communicate with bahasakita speech recognition service.

#### **Table of Contents**
  - [General API Information](#general-api-information)
  - [Tech Stack](#tech-stack)
  - [Diagram Process](#diagram-process)
  - [Text Summarization API](#text-summarization-api) 

## **General API Information**
  - The base endpoint is: 
    - [https://api.bahasakita.co.id](https://api.bahasakita.co.id) for [REST](https://restfulapi.net/)
     - All endpoints return JSON object.

## **Tech Stack**
  - **[REST](https://restfulapi.net/)**  

## **Diagram Process**
 ![Diagram Process](/asset/Text-Summarization.png "Diagram Process")  
 
## **Text Summarization API**
  In order to use this API, you required to create account by registering yourself.

### **"How to Use" Flow**
  1. Get your token with [Our API](./Auth-API.md) 
  2. Send the text you want to summarize and send the other information like title of text and number of sentence to `endpoint-post`. 
  3. Wait for response, it will give you uuid code and message status of translating process.
  4. If you want get the result of summarization, you can get it from `endpoint-get` when message status is `'success'`.
   
### **Host:**
  [https://api.bahasakita.co.id](https://api.bahasakita.co.id)

### **Endpoint**
 Post data (sync): `/v2/prod/summary` \
 Post data (async): `/v2/prod/summary/async` \
 Get data: `/v2/prod/summary/content/<uuid>` \
 Get History data: `/v2/prod/summary/monitoring`

### **Method:**
  `POST` - When you want upload file and send the other information \
  `GET` - When you want get percentage of process or get the result of transcribe 

### **Request - POST (Sync)**
##### **Headers**
  | Name | Format |
  | ------ | ------ |
  | Content-Type | `multipart/form-data` |
  | Authorization | `Bearer token` |

##### **Body**
  | Field | Data Type | Description |
  | ------ | ------ | ------ |
  | File | File | Your document file |
  | Url | String | The url you want to retrieve the content |
  | Text | String | Your input text  |
  | title | String | The title of your text input |
  | check_summary | Boolean | Summary process will also create if `True` |
  | max_sentence_summary | Int | Maximum number of sentences generated by the summarization process |

##### **Response**
  | Field | Data Type | Description |
  | ------ | ------ | ------ |
  | uuid | String | UUID string  |
  | text | String | Your input text  |
  | max_sentence_summary | Int | Maximum number of sentences generated by the summarization process |
  | title | String | The title of your text input |
  | summary | String | The result of text summarization |
  | message_status | String | `'success'`, `'failed'`, `'inquery'` or `'inprogress'` message |

##### **Example Response :**
```json
{
    "bk": {
        "data": {
            "uuid": <string>, 
            "text": <string>, 
            "max_sentence_summary": <int>, 
            "title": <string>, 
            "summary": <string>,
        },
        "message_status": <string>
    }
}
```

### **Request - POST (Async)**
##### **Headers**
  | Name | Format |
  | ------ | ------ |
  | Content-Type | `multipart/form-data` |
  | Authorization | `Bearer token` |

##### **Body**
  | Field | Data Type | Description |
  | ------ | ------ | ------ |
  | File | File | Your document file |
  | Url | String | The url you want to retrieve the content |
  | Text | String | Your input text  |
  | title | String | The title of your text input |
  | max_sentence_summary | Int | Maximum number of sentences generated by the summarization process |

##### **Response**
  | Field | Data Type | Description |
  | ------ | ------ | ------ |
  | uuid | String | UUID string  |
  | text | String | Your input text  |
  | max_sentence_summary | Int | Maximum number of sentences generated by the summarization process |
  | title | String | The title of your text input |
  | message_status | String | `'success'`, `'failed'`, `'inquery'` or `'inprogress'` message |

##### **Example Response :**
```json
{
    "bk": {
        "data": {
            "uuid": <string>, 
            "text": <string>, 
            "max_sentence_summary": <int>, 
            "title": <string>
        },
        "message_status": <string>
    }
}
```

### **Sample Post in Python :**
```python
import requests
import os
from argparse import ArgumentParser


def main():
    parser = ArgumentParser()
    parser.add_argument("-f", "--file", dest="filename",
                help="input data with documents (support: .docx, .pdf, .txt, .srt)", metavar="FILE")
    parser.add_argument("-u", "--url", dest="url",
                help="input data with url-link (article link)")
    parser.add_argument("-t", "--text", dest="text",
                help="input data with text string")
    parser.add_argument("-k", "--keyword", dest="keyword",
                default="", help="title or keyword for summary")
    parser.add_argument("-m", "--max-sentece-sumary", dest="max_sentence_summary",
                default="1", help="total sentence of summary")
    args = parser.parse_args()

    url_post = "https://api.bahasakita.co.id/v2/prod/summary"       ## Sync process
    # url_post = "https://api.bahasakita.co.id/v2/prod/summary/async" ## Async process
    headers= {
        "Authorization": "Bearer <your token>"
    }
    
    if "file" in args:
        file = {
            "file": open(args.filename, "rb")
        }
        
        data = {
            "title": args.keyword, 
            "max_sentence_summary": args.max_sentence_summary
        }

        post_response = requests.request("POST", url_post, headers=headers, files=file, data=data).json()
    else:
        if "url" in args:
            data = {
                "url": args.url, 
                "title": args.keyword, 
                "max_sentence_summary": args.max_sentence_summary
            }

        elif "text" in args:
            data = {
                "text": args.text, 
                "title": args.keyword, 
                "max_sentence_summary": args.max_sentence_summary
            }

        post_response = requests.request("POST", url_post, headers=headers, data=data).json()

    print(post_response)


if __name__ == "__main__":
    main()
```

### **Request - GET (Get Data)**
##### **Headers**
  | Name | Format |
  | ------ | ------ |
  | Content-Type | `multipart/form-data` |
  | Authorization | `Bearer token` |


##### **Response**
  | Field | Data Type | Description |
  | ------ | ------ | ------ |
  | text | String | Your input text  |
  | max_sentence_summary | Int | Maximum number of sentences generated by the summarization process |
  | title | String | The title of your text input |
  | summary | String | The result of text summarization |
  | message_status | String | `'success'`, `'failed'`, `'inquery'` or `'inprogress'` message |
  | created | String | Created request translate datetime (isoformat) |

##### **Example Response :**
```json
{
    "bk": {
        "data": {
            "text": <string>, 
            "max_sentence_summary": <int>, 
            "title": <string>, 
            "summary": <string>
        },
        "message_status": <string>, // status response 
        "created": "0000-00-00 00:00:00" // YYYY-MM-DD HH:mm:ss
    }
}
```

### **Sample Get in Python:**
```python
import requests
import os
from argparse import ArgumentParser


def main():
    parser = ArgumentParser()
    parser.add_argument("-u", "--uuid", dest="uuid", default = None,
                        help="Write your uuid code")
    args = parser.parse_args()
    if args.uuid is None :
        parser.print_help()
        return
    
    headers={"Authorization": "Bearer <your token>"}
    uuid_code = args.uuid    
    url_get = f"https://api.bahasakita.co.id/v2/prod/summary/content/{uuid_code}"

    get_response = requests.request("GET", url_get, headers=headers).json()
    print(get_response)


if __name__ == "__main__":
    main()
```

### **Request - GET (Get History Data)**
##### **Headers**
  | Name | Format |
  | ------ | ------ |
  | Content-Type | `multipart/form-data` |
  | Authorization | `Bearer token` |

##### **Response**
  | Field | Data Type | Description |
  | ------ | ------ | ------ |
  | username | String | Username |
  | history | String | List of request data history |
  | uuid | String | UUID |
  | input_type | String | Input type of data (file, url, or text) |
  | source | String | Resource data (namefile, urllink, or part-of-text) |
  | created_date | String | Time stamp for result |
  | char_length | Int | Length character of text |
  | total_usage | Int | total usage of translation for user |
  | message_status | String | `'success'`, `'failed'`, `'inquery'` or `'inprocess'` message |

##### **Example Response :**
```json
{
    "bk": {
        "data": { 
            "username" : <string>, 
            "history": [
                {
                    "uuid": <string>, 
                    "input_type": <string>, 
                    "source": <string>, 
                    "created_date": datetime.isoformat(), 
                    "char_length": <int>, 
                    "message_status": <string>
                }
            ]
        }, 
        "total_usage": <int>, 
        "message_status" : <string>
    }
}
```

### **Sample Get History in Python:**
```python
import requests
import os
from argparse import ArgumentParser


def main():    
    headers = {
        'Authorization': 'Bearer <your token>'
    }
    
    uuid_code = args.uuid    
    url_get = f"https://api.bahasakita.co.id/v2/prod/summary/monitoring"
    get_response = requests.request("GET", url_get, headers=headers).json()
    print(get_response)


if __name__ == "__main__":
    main()
```
